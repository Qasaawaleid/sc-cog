#!/usr/bin/env python

import os
import sys
import torch
from diffusers import StableDiffusionPipeline

SD_MODEL_CACHE = "diffusers-cache"

os.makedirs(SD_MODEL_CACHE, exist_ok=True)

SD_MODELS = {
  "Stable Diffusion v1.5": {
    "id": "runwayml/stable-diffusion-v1-5",
    "revision": "fp16",
    "torch_dtype": torch.float16
  },
  "Openjourney": {
    "id": "prompthero/openjourney"
  },
  "Redshift Diffusion": {
    "id": "nitrosocke/redshift-diffusion"
  },
  "Arcane Diffusion": {
    "id": "nitrosocke/Arcane-Diffusion"
  },
  "Ghibli Diffusion": {
    "id": "nitrosocke/Ghibli-Diffusion"
  },
  "Mo-Di Diffusion": {
    "id": "nitrosocke/mo-di-diffusion"
  },
  "Waifu Diffusion v1.4": {
    "id": "hakurei/waifu-diffusion"
  },
}

for key in SD_MODELS:
  print(f"⏳ Downloading {key}...")
  pipe = StableDiffusionPipeline.from_pretrained(
    SD_MODELS[key]["id"],
    revision=SD_MODELS[key].get("revision", None),
    torch_dtype=SD_MODELS[key].get("torch_dtype", None),
    cache_dir=SD_MODEL_CACHE,
    use_auth_token=sys.argv[1],
  )
  print(f"✅ Downloaded: {key}")

# For the upscaler
print("⏳ Downloading SwinIR models...")
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/003_realSR_BSRGAN_DFO_s64w8_SwinIR-M_x4_GAN.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/003_realSR_BSRGAN_DFOWMFC_s64w8_SwinIR-L_x4_GAN.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/004_grayDN_DFWB_s128w8_SwinIR-M_noise15.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/004_grayDN_DFWB_s128w8_SwinIR-M_noise25.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/004_grayDN_DFWB_s128w8_SwinIR-M_noise50.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/005_colorDN_DFWB_s128w8_SwinIR-M_noise15.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/005_colorDN_DFWB_s128w8_SwinIR-M_noise25.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/005_colorDN_DFWB_s128w8_SwinIR-M_noise50.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/006_CAR_DFWB_s126w7_SwinIR-M_jpeg10.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/006_CAR_DFWB_s126w7_SwinIR-M_jpeg20.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/006_CAR_DFWB_s126w7_SwinIR-M_jpeg30.pth -P experiments/pretrained_models')
os.system('wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/006_CAR_DFWB_s126w7_SwinIR-M_jpeg40.pth -P experiments/pretrained_models')
print("✅ Downloaded SwinIR models")
        